apiVersion: v1
kind: ConfigMap
metadata:
  name: authelia-config
  namespace: authelia
data:
  configuration.yml: |
    ---
    theme: light
    default_2fa_method: totp

    server:
      address: 'tcp://0.0.0.0:9091/'

    log:
      level: info
      format: text

    telemetry:
      metrics:
        enabled: false

    totp:
      disable: false
      issuer: auth.bh.zz
      algorithm: sha1
      digits: 6
      period: 30
      skew: 1

    webauthn:
      disable: false
      display_name: Homelab
      attestation_conveyance_preference: indirect
      selection_criteria:
        user_verification: preferred
      timeout: 60s

    identity_validation:
      reset_password:
        jwt_secret: insecure_jwt_secret_change_in_production

    authentication_backend:
      password_reset:
        disable: false
      refresh_interval: 5m
      file:
        path: /config/users_database.yml
        password:
          algorithm: argon2
          argon2:
            variant: argon2id
            iterations: 3
            memory: 65536
            parallelism: 4
            key_length: 32
            salt_length: 16

    session:
      secret: insecure_session_secret
      cookies:
        - name: authelia_session
          domain: bh.zz
          authelia_url: https://auth.bh.zz
          default_redirection_url: https://home.bh.zz
          expiration: 1h
          inactivity: 5m
          remember_me: 1M

    storage:
      encryption_key: insecure_encryption_key_change_me_in_production
      local:
        path: /config/db.sqlite3

    notifier:
      disable_startup_check: true
      filesystem:
        filename: /config/notification.txt

    access_control:
      default_policy: deny
      rules:
        - domain: 'auth.bh.zz'
          policy: bypass
        - domain: '*.bh.zz'
          policy: two_factor
